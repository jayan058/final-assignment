var Et=Object.defineProperty;var Yt=(i,t,s)=>t in i?Et(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var e=(i,t,s)=>Yt(i,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))h(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();const et=document.getElementById("gameScreen"),it=document.getElementById("homeScreen");function Bt(){it.style.display="none",et.style.display="flex"}function $t(){it.style.display="flex",et.style.display="none"}let f=[];class N{constructor(t,s,h,a,r,l,d,$,j,A,M){e(this,"x");e(this,"y");e(this,"speed");e(this,"width");e(this,"height");e(this,"image");e(this,"type");e(this,"firstframe");e(this,"lastframe");e(this,"eachwidth");e(this,"eachheight");e(this,"firedPosition");this.x=t,this.y=s,this.firedPosition=this.x,this.speed=h,this.width=d,this.height=l,this.image=new Image,this.image.src=a,this.type=r,this.firstframe=$,this.lastframe=j,this.eachwidth=A,this.eachheight=M}draw(t){console.log("Hello"),t.drawImage(this.image,this.eachwidth*this.firstframe,0,this.eachwidth,this.eachheight,this.x,this.y,this.width,this.height),m%10===0&&(this.firstframe<this.lastframe?this.firstframe+=1:this.firstframe=this.firstframe)}update(t){Math.abs(this.x-this.firedPosition)>=64*3?I(f,t):this.x+=this.speed}}class X{constructor(t,s,h,a,r,l,d,$,j,A,M,b,P,kt,Tt,Ht,Wt,At,Mt){e(this,"x");e(this,"y");e(this,"speed");e(this,"health");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"image");e(this,"width");e(this,"height");e(this,"state");e(this,"attackAnimationFrames");e(this,"hurtAnimationFrames");e(this,"deathAnimationFrames");e(this,"dustCloudAnimationFrames");e(this,"moment");e(this,"attackImageSrc");e(this,"hurtImageSrc");e(this,"deathImageSrc");e(this,"dustCloudImageSrc");e(this,"attackImage");e(this,"hurtImage");e(this,"deathImage");e(this,"dustCloudImage");e(this,"endurance");e(this,"projectileImageSrc");this.x=s,this.y=h,this.speed=a,this.moment=this.speed,this.health=r,this.frameX=l,this.frameY=0,this.eachWidth=$,this.eachHeight=j,this.firstFrame=l,this.lastFrame=d,this.image=new Image,this.image.src=t,this.width=64,this.height=64,this.health=r,this.state="idle",this.attackAnimationFrames=kt,this.hurtAnimationFrames=Tt,this.deathAnimationFrames=Ht,this.dustCloudAnimationFrames=Wt,this.attackImageSrc=A,this.hurtImageSrc=M,this.deathImageSrc=b,this.dustCloudImageSrc=P,this.attackImage=new Image,this.attackImage.src=A,this.hurtImage=new Image,this.hurtImage.src=M,this.deathImage=new Image,this.deathImage.src=b,this.dustCloudImage=new Image,this.dustCloudImage.src=P,this.endurance=At,this.projectileImageSrc=Mt}draw(t){switch(t.fillStyle="gold",t.font="10px Arial",t.fillText(`${this.health}`,this.x+18,this.y),this.state){case"idle":m%25===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame),t.drawImage(this.image,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y-10,this.width,this.height);break;case"attacking":m%15===0&&(this.frameX<this.attackAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),t.drawImage(this.attackImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y-10,this.width,this.height);break;case"hurt":m%15===0&&(this.frameX<this.hurtAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),t.drawImage(this.hurtImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y-10,this.width,this.height);break;case"dead":m%100===0&&(this.frameX<this.deathAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),t.drawImage(this.deathImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y-10,this.width,this.height);break;case"dustcloud":m%30===0&&(this.frameX<this.dustCloudAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),t.drawImage(this.dustCloudImage,200*this.frameX,0,200,179,this.x,this.y-10,this.width,this.height);break}}heroMovement(){m%15===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}}class st extends X{constructor(s,h){super("./images/hero1attack.png",s,h,.2,100,0,13,128,128,"./images/hero1attack_2.png","./images/hero1hurt.png","./images/hero1dead.png","./images/mandrake-dust-cloud.png",3,2,2,4,20,"./images/archerarrow.png");e(this,"shootInterval");e(this,"lastShotTime");this.shootInterval=3e3,this.lastShotTime=0}heroMovement(){const s=Date.now();s-this.lastShotTime>=this.shootInterval&&(this.shoot(),this.lastShotTime=s)}shoot(){const s=new N(this.x+this.width-30,this.y,2,this.projectileImageSrc,"arrow",64,35,0,0,48,48);f.push(s)}}class ht extends X{constructor(s,h){super("./images/hero2attack.png",s,h,.2,100,0,4,128,128,"./images/hero2attack.png","./images/hero2hurt.png","./images/hero2dead.png","./images/mandrake-dust-cloud.png",6,3,3,4,20,"./images/hero2fireball.png");e(this,"shootInterval");e(this,"lastShotTime");this.shootInterval=1e3,this.lastShotTime=500}heroMovement(){const s=Date.now();s-this.lastShotTime>=this.shootInterval&&(this.shoot(),this.lastShotTime=s)}shoot(){const s=new N(this.x+this.width-30,this.y,2,this.projectileImageSrc,"fireball",70,80,0,32,128,128);f.push(s)}}class at extends X{constructor(t,s){super("./images/hero3run.png",t,s,.4,100,0,7,128,128,"./images/hero3attack.png","./images/hero3hurt.png","./images/hero3dead.png","./images/mandrake-dust-cloud.png",3,2,2,4,20,"projectileImageSrc")}heroMovement(){this.x=this.x+this.speed,m%15===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}}class rt extends X{constructor(t,s){super("./images/hero4run.png",t,s,.4,100,0,5,96.4,98,"./images/hero4attack.png","./images/hero4hurt.png","./images/hero4dead.png","./images/mandrake-dust-cloud.png",2,2,3,4,5,"projectileImageSrc")}heroMovement(){this.x=this.x+this.speed,m%15===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}}class ot extends X{constructor(t,s){super("./images/hero5run.png",t,s,.4,100,0,5,96.4,98,"./images/hero5attack.png","./images/hero5hurt.png","./images/hero5dead.png","./images/mandrake-dust-cloud.png",2,0,3,4,10,"projectileImageSrc")}heroMovement(){this.x=this.x+this.speed,m%15===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}}class nt extends X{constructor(t,s){super("./images/hero6run.png",t,s,.4,100,0,7,128,128,"./images/hero6attack.png","./images/hero6hurt.png","./images/hero6dead.png","./images/mandrake-dust-cloud.png",3,2,2,4,5,"projectileImageSrc")}heroMovement(){this.x=this.x+this.speed,m%15===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}}class mt extends X{constructor(s,h){super("./images/hero7attack.png",s,h,.2,100,0,3,130,130,"./images/hero7attack.png","./images/hero7dead.png","./images/hero1dead.png","./images/mandrake-dust-cloud.png",3,1,5,4,10,"./images/jinifireball.png");e(this,"shootInterval");e(this,"lastShotTime");this.shootInterval=1e3,this.lastShotTime=500}heroMovement(){const s=Date.now();s-this.lastShotTime>=this.shootInterval&&(this.shoot(),this.lastShotTime=s)}shoot(){const s=new N(this.x+this.width-30,this.y,2,this.projectileImageSrc,"fireball",68,68,0,9,642,642);f.push(s)}}class lt extends X{constructor(s,h){super("./images/hero8attack.png",s,h,.2,100,0,6,128,128,"./images/hero8attack.png","./images/hero8hurt.png","./images/hero8dead.png","./images/mandrake-dust-cloud.png",6,3,8,4,20,"./images/hero8fireball.png");e(this,"shootInterval");e(this,"lastShotTime");this.shootInterval=1300,this.lastShotTime=500}heroMovement(){const s=Date.now();s-this.lastShotTime>=this.shootInterval&&(this.shoot(),this.lastShotTime=s)}shoot(){const s=new N(this.x+this.width-30,this.y,2,this.projectileImageSrc,"fireball",60,60,0,12,128,128);f.push(s)}}const k=document.getElementById("canvas1"),g=k.getContext("2d"),T=new Audio;T.src="./sound/resouce-increase.mp3";const q=[],C=[];let n=null;function F(i,t,s,h,a,r,l,d,$,j,A,M){const b=new Image;b.src=i;const P={x:t,y:s,width:64,height:64,imageSrc:i,frameX:0,frameY:0,eachWidth:r,eachHeight:l,firstFrame:h,lastFrame:a,image:b,heroClass:d,cost:$,name:j,imageX:A,imageY:M};return q.push(P),P}F("./images/card1.png",64*4,0,0,21,128,128,st,100,"Archer",64*4,0);F("./images/card2.png",64*5,0,0,11,128,128,ht,100,"Wizard",64*5,0);F("./images/card3.png",64*6,0,0,19,128,128,at,100,"Swordsman",64*6,0);function jt(){g.clearRect(0,0,k.width,k.height),q.forEach(i=>{g.strokeStyle="black",g.strokeRect(i.x,i.y,i.width,i.height),g.fillStyle="purple",g.fillRect(i.x,i.y,i.width,i.height),m%17===0&&(i.frameX<i.lastFrame?i.frameX+=1:i.frameX=i.firstFrame),g.fillStyle="gold",g.font="10px Arial",g.fillText(`${i.name}`,i.x+11,i.y+10),g.fillText(`Cost:${i.cost}`,i.x+11,i.y+20),g.drawImage(i.image,i.eachWidth*i.frameX,0,i.eachWidth,i.eachHeight,i.imageX,i.imageY,i.width,i.height)})}const J=new Set;function Q(i,t){const s=`${i},${t}`;return J.has(s)}k.addEventListener("click",i=>{const t=k.getBoundingClientRect();let s=i.clientX-t.left,h=i.clientY-t.top;if(s=s-s%64,h=h-h%64,!n||n&&h==0)q.forEach(a=>{s>=a.x&&s<=a.x+a.width&&h>=a.y&&h<=a.y+a.height&&(n=a)});else{if(h>=64&&h<=564&&s>=128)if(n.heroClass===at||n.heroClass===rt||n.heroClass===ot||n.heroClass===nt||n.heroClass==mt||n.heroClass==lt){const a=new n.heroClass(s,h);C.push(a)}else if(!Q(s,h)&&n.heroClass==st||!Q(s,h)&&n.heroClass==ht){const a=new n.heroClass(s,h);C.push(a);const r=`${s},${h}`;J.add(r)}else console.log("Cannot drop hero on an occupied grid position.");else console.log("Cannot place hero in the first or last row.");n=null}});function bt(){for(var i=0;i<=C.length-1;i++)C[i].heroMovement(),C[i].draw(g);ct();for(let t=f.length-1;t>=0;t--)f[t]&&f[t].update(f[t]),f[t]&&f[t].draw(g)}setTimeout(()=>{T.play(),F("./images/card4.png",64*7,0,0,9,96.4,98,rt,150,"Kings Guard",64*7,0)},0);setTimeout(()=>{T.play(),F("./images/card5.png",64*8,0,0,11,96.4,98,ot,150,"Viking Hero",64*8,0)},0);setTimeout(()=>{T.play(),F("./images/card6.png",64*9,0,0,11,128.2,130,nt,200,"Fighter",64*9,0)},0);setTimeout(()=>{T.play(),F("./images/card7.png",64*10,0,0,6,130,130,mt,200,"Jinn",64*10,10)},0);setTimeout(()=>{T.play(),F("./images/card8.png",64*11,0,0,14,130,130,lt,200,"Wizard Girl",64*11,10)},0);let dt=300;function Pt(i){dt+=i,T.play()}let y=null,p=null;k.addEventListener("mousemove",i=>{const t=k.getBoundingClientRect();y=i.clientX-t.left,p=i.clientY-t.top,ct()});function ct(){y&&(y=y-y%64),p&&(p=p-p%64),n&&y!==null&&p!==null&&p>=64&&p<576&&y>=128&&(m%25===0&&(n.frameX<n.lastFrame?n.frameX+=1:n.frameX=n.firstFrame),g.strokeStyle="gold",g.strokeRect(y,p,64,64),g.drawImage(n.image,n.eachWidth*n.frameX,0,n.eachWidth,n.eachHeight,y,p-10,n.width,n.height))}const gt=document.getElementById("canvas1"),o=gt.getContext("2d"),Rt=8;let w=[],c=[];const ft=new Image;ft.src="./images/enemy1.png";w.push(ft);const ut=new Image;ut.src="./images/enemy2.png";w.push(ut);const pt=new Image;pt.src="./images/enemy3.png";w.push(pt);const wt=new Image;wt.src="./images/enemy4.png";w.push(wt);const yt=new Image;yt.src="./images/enemy5.png";w.push(yt);class L{constructor(t,s,h,a){e(this,"x");e(this,"y");e(this,"width");e(this,"height");this.x=t,this.y=s,this.width=h,this.height=a}draw(){}enemyMovement(){}}class Dt extends L{constructor(s,h){super(s,h,H-30,W-30);e(this,"speed");e(this,"moment");e(this,"health");e(this,"pointsAwarded");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"enemytype");e(this,"thrownBlades");e(this,"lastThrowTime");e(this,"throwInterval");this.speed=1,this.moment=this.speed,this.health=100,this.pointsAwarded=this.health,this.frameX=0,this.frameY=0,this.eachWidth=213,this.eachHeight=213,this.firstFrame=0,this.lastFrame=8,this.enemytype=w[0],this.thrownBlades=[],this.lastThrowTime=0,this.throwInterval=8e3}enemyMovement(){this.x-=this.speed,m%10===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}draw(){o.fillStyle="gold",o.font="10px Arial",o.fillText(this.health.toString(),this.x+10,this.y),o.drawImage(this.enemytype,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height)}throwNinjaBlade(){const s=Date.now();if(s-this.lastThrowTime>this.throwInterval){const h=new Lt(this.x,this.y+this.height/2);this.thrownBlades.push(h),this.lastThrowTime=s}}}class Lt{constructor(t,s){e(this,"x");e(this,"y");e(this,"radius");e(this,"speed");e(this,"thornLength");e(this,"thornCount");this.x=t,this.y=s,this.radius=5,this.speed=1,this.thornLength=5,this.thornCount=8}update(){this.x-=this.speed}draw(){o.fillStyle="black",o.strokeStyle="black",o.lineWidth=2,o.beginPath(),o.arc(this.x,this.y,this.radius,0,Math.PI*2,!1),o.fill(),o.stroke();for(let t=0;t<this.thornCount;t++){const s=t*(2*Math.PI)/this.thornCount,h=this.x+this.radius*Math.cos(s),a=this.y+this.radius*Math.sin(s),r=this.x+(this.radius+this.thornLength)*Math.cos(s),l=this.y+(this.radius+this.thornLength)*Math.sin(s);o.beginPath(),o.moveTo(h,a),o.lineTo(r,l),o.stroke()}}}class zt extends L{constructor(s,h){super(s,h,H,W);e(this,"speed");e(this,"moment");e(this,"health");e(this,"pointsAwarded");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"enemytype");e(this,"state");e(this,"attackAnimationFrames");e(this,"hurtAnimationFrames");e(this,"deathAnimationFrames");e(this,"dustCloudAnimationFrames");e(this,"attackImageSrc");e(this,"hurtImageSrc");e(this,"deathImageSrc");e(this,"dustCloudImageSrc");e(this,"attackImage");e(this,"hurtImage");e(this,"deathImage");e(this,"dustCloudImage");e(this,"endurance");e(this,"isCollidingWithVilan");e(this,"isCollidingWithHero");this.speed=.3,this.moment=this.speed,this.health=120,this.pointsAwarded=this.health,this.frameX=0,this.frameY=0,this.eachWidth=900,this.eachHeight=900,this.firstFrame=1,this.lastFrame=11,this.enemytype=w[1],this.attackAnimationFrames=11,this.hurtAnimationFrames=11,this.deathAnimationFrames=14,this.dustCloudAnimationFrames=4,this.attackImageSrc="./images/zomievillagerattack.png",this.hurtImageSrc="./images/zomievillagerhurt.png",this.deathImageSrc="./images/zomievillagerdeath.png",this.dustCloudImageSrc="./images/mandrake-dust-cloud.png",this.attackImage=new Image,this.attackImage.src=this.attackImageSrc,this.hurtImage=new Image,this.hurtImage.src=this.hurtImageSrc,this.deathImage=new Image,this.deathImage.src=this.deathImageSrc,this.dustCloudImage=new Image,this.dustCloudImage.src=this.dustCloudImageSrc,this.state="idle",this.endurance=30,this.isCollidingWithVilan=!1,this.isCollidingWithHero=!1}enemyMovement(){this.x=this.x-this.speed,m%10===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}draw(){switch(o.fillStyle="gold",o.font="10px Arial",o.fillText(this.health.toString(),this.x+25,this.y+10),this.state){case"idle":m%20===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame),o.drawImage(this.enemytype,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height);break;case"attacking":m%25===0&&(this.frameX<this.attackAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),o.drawImage(this.attackImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height);break;case"hurt":m%20===0&&(this.frameX<this.hurtAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),o.drawImage(this.hurtImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height);break;case"dead":m%30===0&&(this.frameX<this.deathAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),o.drawImage(this.deathImage,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height);break;case"dustcloud":m%20===0&&(this.frameX<this.dustCloudAnimationFrames?this.frameX+=1:this.frameX=this.firstFrame),o.drawImage(this.dustCloudImage,200*this.frameX,0,200,179,this.x,this.y,this.width,this.height);break}}}class Ot extends L{constructor(s,h){super(s,h,H,W);e(this,"speed");e(this,"moment");e(this,"health");e(this,"pointsAwarded");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"enemytype");this.speed=.2,this.moment=this.speed,this.health=100,this.pointsAwarded=this.health,this.frameX=0,this.frameY=0,this.eachWidth=900,this.eachHeight=900,this.firstFrame=0,this.lastFrame=11,this.enemytype=w[2]}enemyMovement(){this.x=this.x-this.speed,m%10===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}draw(){o.fillStyle="gold",o.font="10px Arial",o.fillText(this.health.toString(),this.x+25,this.y+10),o.drawImage(this.enemytype,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height)}}class Gt extends L{constructor(s,h){super(s,h,H-30,W-30);e(this,"speed");e(this,"moment");e(this,"health");e(this,"pointsAwarded");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"enemytype");this.speed=.2,this.moment=this.speed,this.health=100,this.pointsAwarded=this.health,this.frameX=0,this.frameY=0,this.eachWidth=271,this.eachHeight=194,this.firstFrame=0,this.lastFrame=5,this.enemytype=w[3]}enemyMovement(){this.x=this.x-this.speed,m%10===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}draw(){o.fillStyle="gold",o.font="10px Arial",o.fillText(this.health.toString(),this.x+10,this.y),o.drawImage(this.enemytype,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height)}}class Nt extends L{constructor(s,h){super(s,h,H,W);e(this,"speed");e(this,"moment");e(this,"health");e(this,"pointsAwarded");e(this,"frameX");e(this,"frameY");e(this,"eachWidth");e(this,"eachHeight");e(this,"firstFrame");e(this,"lastFrame");e(this,"enemytype");e(this,"attackInterval");this.speed=.2,this.moment=this.speed,this.health=120,this.pointsAwarded=this.health,this.frameX=0,this.frameY=0,this.eachWidth=900,this.eachHeight=900,this.firstFrame=0,this.lastFrame=11,this.enemytype=w[4],this.attackInterval=20}enemyMovement(){this.x=this.x-this.speed,m%10===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame)}draw(){o.fillStyle="gold",o.font="10px Arial",o.fillText(this.health.toString(),this.x+25,this.y+10),o.drawImage(this.enemytype,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height)}}const Vt=[64,128,192,256,320,384,448,512,576],Z=[Dt,zt,Ot,Gt,Nt];let z=5e3,_=-z;function Kt(){const i=Date.now();if(i-_>z){_=i;const t=Math.floor(Math.random()*Rt),s=Vt[t],h=Math.floor(Math.random()*Z.length),a=new Z[h](gt.width,s);c.push(a),z>1500&&(z-=100)}}function qt(){for(let i=0;i<c.length;i++)c[i].enemyMovement(),c[i].draw(),c[i].x+c[i].width<0&&(c.splice(i,1),i--)}const xt=document.getElementById("canvas1"),Jt=xt.getContext("2d");var It=new Image;It.src="./images/projectilefortower.png";class Ut{constructor(t,s,h,a,r=0){e(this,"x");e(this,"y");e(this,"targetX");e(this,"targetY");e(this,"startX");e(this,"startY");e(this,"peakHeight");e(this,"speed");e(this,"progress");e(this,"width");e(this,"height");this.x=t,this.y=s,this.startX=t,this.startY=s,this.targetX=h,this.targetY=a,this.peakHeight=r,this.speed=h>384?.3:.7,this.progress=0,this.width=25,this.height=25}update(){this.progress+=this.speed;const t=Math.hypot(this.targetX-this.startX,this.targetY-this.startY),s=this.progress/t;this.x=this.startX+(this.targetX-this.startX)*s,this.y=this.startY+(this.targetY-this.startY)*s,s>=1&&(this.progress=t+xt.width)}draw(){Jt.drawImage(It,this.x,this.y,this.width,this.height)}}const Qt=document.getElementById("canvas1"),E=Qt.getContext("2d");let O=[];const Zt="#00FF00",_t="#FF0000",u=class u{constructor(t,s,h,a,r,l,d){e(this,"height");e(this,"width");e(this,"x");e(this,"y");e(this,"firstFrame");e(this,"lastFrame");e(this,"frameX");e(this,"tower");e(this,"eachWidth");e(this,"eachHeight");e(this,"lastShootTime");e(this,"shootInterval");e(this,"defaultShootInterval");e(this,"collisionShootInterval");e(this,"isColliding");e(this,"health");e(this,"maxHealth");e(this,"dustCloudSprite");e(this,"dustCloudFrames");e(this,"dustCloudFrameIndex");e(this,"dustCloudFrameWidth");this.height=t,this.width=s,this.x=h,this.y=a,this.firstFrame=r,this.lastFrame=l,this.frameX=d,this.tower=new Image,this.tower.src="./images/tower.png",this.eachWidth=128,this.eachHeight=144,this.lastShootTime=0,this.defaultShootInterval=5e3,this.collisionShootInterval=100,this.shootInterval=this.defaultShootInterval,this.isColliding=!1,this.maxHealth=400,this.health=this.maxHealth,this.dustCloudSprite=new Image,this.dustCloudSprite.src="./images/mandrake-dust-cloud.png",this.dustCloudFrames=4,this.dustCloudFrameIndex=0,this.dustCloudFrameWidth=200}draw(){m%14===0&&(this.frameX<this.lastFrame?this.frameX+=1:this.frameX=this.firstFrame),E.drawImage(this.tower,this.eachWidth*this.frameX,0,this.eachWidth,this.eachHeight,this.x,this.y,this.width,this.height),this.drawHealthBar(),this.launchProjectile(),O.forEach(t=>{t.update(),t.draw()})}launchProjectile(){const t=Date.now();if(t-this.lastShootTime>this.shootInterval&&R.indexOf(this)===u.shooterIndex){let s=this.findNearestEnemy();if(s){const a=new Ut(this.x+60,this.y,s.x,s.y,100);O.push(a),this.lastShootTime=t}}console.log(`Tower at (${this.x}, ${this.y}) shoot interval: ${this.shootInterval}`)}static updateShooter(){const t=Date.now();t-u.lastShooterChangeTime>u.shooterChangeInterval&&(u.shooterIndex=(u.shooterIndex+1)%R.length,u.lastShooterChangeTime=t,console.log(`Shooter changed to tower index: ${u.shooterIndex}`))}findNearestEnemy(){let t=1/0,s=c[0];const h=Math.random()<.5?this.y:this.y+64;return c.forEach(a=>{if(a.y>=h&&a.y<=h+64){const r=Math.hypot(a.x-this.x,a.y-this.y);r<t&&r<=64*3&&(t=r,s=a)}}),s}drawHealthBar(){const t=this.width,s=8,h=this.x,a=this.y-s+4;E.fillStyle=_t,E.fillRect(h,a,t,s);const r=this.health/this.maxHealth;E.fillStyle=Zt,E.fillRect(h,a,t*r,s),this.health<=0&&(m%20===0&&(this.frameX<4?this.frameX+=1:this.frameX=this.firstFrame),E.drawImage(this.dustCloudSprite,200*this.frameX,0,200,179,this.x,this.y,this.width+20,this.height),setTimeout(()=>{I(R,this)},1e3))}checkCollisionWithEnemies(){this.isColliding=!1;for(let t of c)if(this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y){t.speed=0,t.x=t.x+2,t.state="attacking",this.isColliding=!0,this.health-=10,this.shootInterval=this.collisionShootInterval;break}this.isColliding||(this.shootInterval=this.defaultShootInterval),console.log(`Tower at (${this.x}, ${this.y}) is colliding: ${this.isColliding}, health: ${this.health}`)}};e(u,"shooterIndex",0),e(u,"shooterChangeInterval",3e3),e(u,"lastShooterChangeTime",Date.now());let v=u;const R=[new v(128,128,0,64,0,11,0),new v(128,128,0,192,0,11,0),new v(128,128,0,320,0,11,0),new v(128,128,0,448,0,11,0)];function te(){v.updateShooter(),R.forEach(i=>{i.checkCollisionWithEnemies(),i.draw()})}const ee=document.getElementById("canvas1"),V=ee.getContext("2d");function ie(){V.fillStyle="gold",V.font="20px Arial",V.fillText("Coins: "+dt,0,50)}function se(){for(let i of C)for(let t of c)i.x<t.x+t.width&&i.x+i.width>t.x&&i.y<t.y+t.height&&i.y+i.height>t.y&&(t.isCollidingWithHero=!0,t.isCollidingWithVillain=!1,(i.speed>0&&i.x<t.x||i.speed<0&&i.x>t.x)&&(i.speed=0,t.speed=0,i.state="attacking",t.state="attacking",he(i,t)))}function he(i,t){let s=!0;const h=setInterval(()=>{i.health<=0||t.health<=0?(clearInterval(h),i.health<=0?(i.state="dead",setTimeout(()=>{i.state="dustcloud"},400),setTimeout(()=>{t.speed=t.moment,I(C,i);const r=`${i.x},${i.y}`;J.delete(r)},800)):i.state="idle",t.health<=0?(t.state="dead",setTimeout(()=>{t.state="dustcloud",i.state="idle"},400),setTimeout(()=>{i.speed=i.moment,I(c,t)},800)):t.state="idle"):(s?(i.state="attacking",t.state="hurt"):(i.state="hurt",t.state="attacking"),s=!s)},500),a=setInterval(()=>{i.health<=0||t.health<=0?clearInterval(a):(i.health-=i.endurance,t.health-=t.endurance)},500)}function I(i,t){const s=i.indexOf(t);s>-1&&i.splice(s,1)}function ae(){for(let i of c)for(let t of f)t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.height&&t.y+t.height>i.y&&(I(f,t),i.health-=i.endurance,i.health<=0?(i.state="dead",i.speed=0,setTimeout(()=>{i.state="dustcloud",setTimeout(()=>{I(c,i)},500)},500)):(i.state="hurt",i.speed=0,setTimeout(()=>{i.state="idle",i.speed=i.moment},500)))}function re(){for(let i of R)for(let t of c)i.x<t.x+t.width&&i.x+i.width>t.x&&i.y<t.y+t.height&&i.y+i.height>t.y&&(t.speed=0,t.x=t.x,t.state="attacking")}function oe(){for(let i of O)for(let t of c)i.x<t.x+t.width&&i.x+i.width>t.x&&i.y<t.y+t.height&&i.y+i.height>t.y&&(I(O,i),t.health-=t.endurance,t.health<=0?(t.state="dead",t.speed=0,setTimeout(()=>{t.state="dustcloud",setTimeout(()=>{I(c,t)},500)},500)):(t.state="hurt",t.speed=0,setTimeout(()=>{t.state="idle",t.speed=t.moment},500)))}const D=document.getElementById("canvas1"),Xt=D.getContext("2d"),Ft=new Image;Ft.src="./images/mandrake.png";const ne=new Image;ne.src="./images/mandrake-dust-cloud.png";const G=64,Y=64,me=110;let tt=[50,60,70,80],B=[];class le{constructor(t,s,h){e(this,"x");e(this,"y");e(this,"size");e(this,"gamePoint");e(this,"creationTime");e(this,"frameX");e(this,"frameY");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"minFrame");e(this,"maxFrame");this.x=t,this.y=s,this.size=h,this.gamePoint=tt[Math.floor(Math.random()*tt.length)],this.creationTime=Date.now(),this.frameX=0,this.frameY=0,this.spriteWidth=256,this.spriteHeight=256,this.minFrame=0,this.maxFrame=355}draw(t){m%2===0&&(this.frameX++,this.frameX>=18&&(this.frameX=0,this.frameY++,this.frameY>=18&&(this.frameY=0))),Xt.drawImage(Ft,this.frameX*this.spriteWidth,this.frameY*this.spriteHeight,this.spriteWidth,this.spriteHeight,this.x+(G-this.size)/2,this.y+(Y-this.size)/2,Y*2,Y*2),t.fillStyle="gold",t.font="10px Arial",t.fillText(this.gamePoint.toString(),this.x+25,this.y)}isExpired(){return Date.now()-this.creationTime>5500}isHovered(t,s,h){const a=t>=this.x&&t<=this.x+G*1.3&&s>=this.y&&s<=this.y+Y*1.3;return a&&Pt(h.gamePoint),a}}function de(){const i=D.width/G,t=D.height/Y,s=Math.floor(Math.random()*(i-2))+2,h=Math.floor(Math.random()*(t-1))+1,a=s*G,r=h*Y;return{x:a,y:r}}function ce(){const{x:i,y:t}=de(),s=new le(i,t,me);B.push(s)}function ge(){B=B.filter(i=>!i.isExpired());for(let i of B)i.draw(Xt)}D.addEventListener("mousemove",i=>{const t=D.getBoundingClientRect(),s=i.clientX-t.left,h=i.clientY-t.top;B=B.filter(a=>!a.isHovered(s,h,a))});let fe=Date.now();const x=document.getElementById("canvas1"),vt=x.getContext("2d");x.height=576;x.width=1344;let m=0;const H=64,W=64,St=new Image;St.src="./images/hovertile.png";class ue{constructor(t,s){e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"isHovered");this.x=t,this.y=s,this.width=H,this.height=W,this.isHovered=!1}draw(){this.isHovered&&vt.drawImage(St,this.x,this.y,this.width,this.height)}}const S=[];function pe(){for(let i=64;i<x.height;i+=W)for(let t=128;t<x.width;t+=H)S.push(new ue(t,i))}pe();function Ct(){for(let i=0;i<S.length;i++)S[i].draw()}x.addEventListener("mousemove",function(i){const t=x.getBoundingClientRect(),s=i.clientX-t.left,h=i.clientY-t.top;let a=null,r=null;for(let l=0;l<S.length;l++){const d=S[l];if(s>=d.x&&s<d.x+d.width&&h>=d.y&&h<d.y+d.height){a=d.y,r=d.x;break}}for(let l=0;l<S.length;l++){const d=S[l];d.x===r||d.y===a?d.isHovered=!0:d.isHovered=!1}Ct()});function U(){vt.clearRect(0,0,x.width,x.height),jt(),Ct(),ie(),bt(),m++,(Date.now()-fe)/1e3<5*60&&(qt(),Kt()),ge(),se(),ae(),te(),re(),oe(),requestAnimationFrame(U)}U();setInterval(ce,5e3);var K=new Audio;K.src="./sound/maintheme.mp3";const we=document.getElementById("startButton");we.addEventListener("click",()=>{K.play(),K.loop=!0,Bt(),U()});$t();
